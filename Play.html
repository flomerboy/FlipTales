<head>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="icon" type="image/png" href="assets/images/favicon.png"/>
  <title>FlipTales FAQ</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-123279486-1"></script>
  <meta content="width=device-width, initial-scale=1" name="viewport" />

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-123279486-1');
  </script>
</head>
<body>
  <nav>
    <a href="https://playfliptales.com"><img src="assets/images/fliptales-green-logo.svg" alt="logo-green-nav"></a>
    <form class="button nav-item" action="https://shop.playfliptales.com/products/fliptales-first-edition" method="get">
      <input type="submit" name="shop button" value="SHOP">
    </form>
    <form class="button-invert nav-item" action="https://playfliptales.com/stories" method="get">
      <input type="submit" name="sign up button" value="COMMUNITY">
    </form>
    <form class="button-invert nav-item" action="https://playfliptales.com/FAQ" method="get">
      <input type="submit" name="FAQ button" value="FAQ">
    </form>
    <form class="button-invert nav-item" action="https://playfliptales.com/Play" method="get">
      <input type="submit" name="Play button" value="PLAY">
    </form>
  </nav>
  <img id="mobile-menu" src="assets/images/icon-menu.svg" />
  <script>
    let menu_icon = document.getElementById("mobile-menu");
    let menu_items = document.getElementsByClassName("nav-item");
    let menu_is_open = false;
    menu_icon.onclick = function(){
      console.log("ho")
      if (menu_is_open) {
        for (let i = 0; i < menu_items.length; i++) {
          setTimeout(function() {
          menu_items[i].style.display = "none";
          }, i*40);
        }
        menu_icon.src = "assets/images/icon-menu.svg"
      } else {
        for (let i = 0; i < menu_items.length; i++) {
          setTimeout(function() {
          menu_items[i].style.display = "block";
        }, i*40);
        }
        menu_icon.src = "assets/images/icon-close.svg"
      }
      menu_is_open = !menu_is_open;
    }
  </script>
  <br>

  <br>
  <br>

  <br>
  <article>
  <h1 id="digitalCardsHeader">Digital Cards & Coins</h1>
  </article>
    <div class="playing-card-container" >
      <div class="vertical-stack" id="creature">
        <img class="playing-card" id="creatureCard" src="assets/images/Creature-4-front.jpg" alt="">
        <select class="classic" name="creature" id="creature-selector">
          <option value="4">Arboroid</option>
          <option value="1">Sauroid</option>
          <option value="2">Wingoid</option>
          <option value="3">Insectoid</option>
        </select>
      </div>
      <div class="vertical-stack" id="ability">
        <img class="playing-card" id="abilityCard" src="assets/images/Ability-1-front.jpg" alt="">
        <select name="ability" id="ability-selector">
          <option value="1">Fungus Lord</option>
          <option value="2">Performer</option>
          <option value="3">Elementalist</option>
          <option value="4">Inventor</option>
        </select>
      </div>
    </div>
    <div class="coinsContainer">
      <div id="strength">
        <ul class="coins" id="strengthCoins">
          <li onclick="flipCoins(this,0);"><img src="assets/images/coin-strength-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,0);"><img src="assets/images/coin-strength-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,0);"><img src="assets/images/coin-strength-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,0);"><img src="assets/images/coin-strength-heads.svg" alt=""></li>
        </ul>
        <ul class="coin-control-panel">
          <li class="controls" id="strengthControls">
            <img id="strength-minus" src="assets/images/strength-adjust-minus.svg" alt="">
            <img id="strength-plus" src="assets/images/strength-adjust-plus.svg" alt="">
            <button onclick="flipCoins(this,0);" class="coin-controls"><img class="button-icon" src="assets/icons/flip.svg" />Flip</button>
            <button onclick="resetCoins(0);" class="coin-controls"><img class="button-icon" src="assets/icons/reset.svg" />Reset</button>
          </li>
        </ul>
      </div>
      <div id="magic">
        <ul class="coins" id="magicCoins">
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,1);"><img src="assets/images/coin-magic-heads.svg" alt=""></li>
        </ul>
        <ul class="coin-control-panel">
          <li class="controls" id="magicControls">
            <img id="magic-minus" src="assets/images/magic-adjust-minus.svg" alt="">
            <img id="magic-plus" src="assets/images/magic-adjust-plus.svg" alt="">
            <button onclick="flipCoins(this,1);" class="coin-controls"><img class="button-icon" src="assets/icons/flip.svg" />Flip</button>
            <button onclick="resetCoins(1);" class="coin-controls"><img class="button-icon" src="assets/icons/reset.svg" />Reset</button>
          </li>
        </ul>
      </div>
      <div id="smarts">
        <ul class="coins" id="smartsCoins">
          <li onclick="flipCoins(this,2);"><img src="assets/images/coin-smarts-heads.svg" alt=""></li>
          <li onclick="flipCoins(this,2);"><img src="assets/images/coin-smarts-heads.svg" alt=""></li>
        </ul>
        <ul class="coin-control-panel">
          <li class="controls" id="smartsControls">
            <img id="smarts-minus" src="assets/images/smarts-adjust-minus.svg" alt="">
            <img id="smarts-plus" src="assets/images/smarts-adjust-plus.svg" alt="">
            <button onclick="flipCoins(this,2);" class="coin-controls"><img class="button-icon" src="assets/icons/flip.svg" />Flip</button>
            <button onclick="resetCoins(2);" class="coin-controls"><img class="button-icon" src="assets/icons/reset.svg" />Reset</button>
          </li>
        </ul>
      </div>
  </div>
    <script>
      let creatureIndex = 4;
      let abilityIndex = 1;
      let creatureCardIsFaceUp = true;
      let abilityCardIsFaceUp = true;

      let allow_hover_effects = true;

      let abilityCardStats = [
        [2,4,1], //fungus lord
        [3,3,1], //performer
        [1,4,2], //elementalist
        [2,1,4] //inventor
      ]

      let creatureCardStats = [
        [1,2,4], //sauroid
        [3,1,3], //wingoid
        [2,3,2], //insectoid
        [2,4,1]  //arboroid
      ]

      let currentCharacterStats = [0,0,0];
      let currentCharacterBonuses = [0,0,0];

      currentCharacterStats[0] = abilityCardStats[abilityIndex - 1][0] + creatureCardStats[creatureIndex - 1][0] + currentCharacterBonuses[0];
      currentCharacterStats[1] = abilityCardStats[abilityIndex - 1][1] + creatureCardStats[creatureIndex - 1][1] + currentCharacterBonuses[1];
      currentCharacterStats[2] = abilityCardStats[abilityIndex - 1][2] + creatureCardStats[creatureIndex - 1][2] + currentCharacterBonuses[2];

      let creatureCard = document.getElementById("creatureCard");
      let abilityCard = document.getElementById("abilityCard");
      let creatureSelector = document.getElementById("creature-selector");
      let abilitySelector = document.getElementById("ability-selector");

      let strengthCoins = document.getElementById("strengthCoins");
      let magicCoins = document.getElementById("magicCoins");
      let smartsCoins = document.getElementById("smartsCoins");

      let strengthPlus = document.getElementById("strength-plus");
      let strengthMinus = document.getElementById("strength-minus");
      let magicPlus = document.getElementById("magic-plus");
      let magicMinus = document.getElementById("magic-minus");
      let smartsPlus = document.getElementById("smarts-plus");
      let smartsMinus = document.getElementById("smarts-minus");

      let strengthControls = document.getElementById("strengthControls");
      let magicControls = document.getElementById("magicControls");
      let smartsControls = document.getElementById("smartsControls");

      let strength = document.getElementById("strength");
      let magic = document.getElementById("magic");
      let smarts = document.getElementById("smarts");

      let coinControls = [strengthControls, magicControls, smartsControls];

      let animationInProgress = {'creature': false, 'ability': false};

      let imageURLs = [
        'assets/images/Ability-1-back.jpg','assets/images/Ability-1-front.jpg',
        'assets/images/Ability-2-back.jpg','assets/images/Ability-2-front.jpg',
        'assets/images/Ability-3-back.jpg','assets/images/Ability-3-front.jpg',
        'assets/images/Ability-4-back.jpg','assets/images/Ability-4-front.jpg',
        'assets/images/Creature-1-back.jpg','assets/images/Creature-1-front.jpg',
        'assets/images/Creature-2-back.jpg','assets/images/Creature-2-front.jpg',
        'assets/images/Creature-3-back.jpg','assets/images/Creature-3-front.jpg',
        'assets/images/Creature-4-back.jpg','assets/images/Creature-4-front.jpg',
      ];

      for (let i = 0; i < imageURLs.length; i++){
        preloadImage(imageURLs[i]);
      }

      strengthPlus.onclick = strengthMinus.onclick = magicPlus.onclick = magicMinus.onclick = smartsPlus.onclick = smartsMinus.onclick = function(){
        bonusCoins(this); //add or remove coins when these buttons are clicked
      }

      creatureSelector.onchange = function (){ 
        creatureIndex = creatureSelector.value;//update index of creature
        currentCharacterStats[0] = abilityCardStats[abilityIndex - 1][0] + creatureCardStats[creatureIndex - 1][0];//update individual stats
        currentCharacterStats[1] = abilityCardStats[abilityIndex - 1][1] + creatureCardStats[creatureIndex - 1][1];
        currentCharacterStats[2] = abilityCardStats[abilityIndex - 1][2] + creatureCardStats[creatureIndex - 1][2];
        if (creatureCard.style.transform.includes("180deg")){ //if the card is face up, flip it over
          creatureCard.style.transform = "rotateY(0deg)"
          setTimeout(function(){
            creatureCard.src = "assets/images/Creature-" + creatureIndex+ "-front.jpg";
            creatureCardIsFaceUp = true;
            animationInProgress.creature = false;
          },250);
        } else {
          creatureCard.src = "assets/images/Creature-" + creatureIndex + "-front.jpg";
        }

        creatureCardIsFaceUp = true;
        matchStatsToNewSelection();
        matchCoinsToStats();
        flipAllCoins();
      }

      abilitySelector.onchange = function (){
        abilityIndex = abilitySelector.value; //update index of current ability
        
        if (abilityCard.style.transform.includes("180deg")) { //if the card is face up, flip it over
          abilityCard.style.transform = "rotateY(0deg)"
          setTimeout(function(){
            abilityCard.src = "assets/images/Ability-" + abilityIndex+"-front.jpg";
            abilityCardIsFaceUp = true;
            animationInProgress.ability = false;
          },250);
        } else {
          abilityCard.src = "assets/images/Ability-" + abilityIndex+"-front.jpg";
        }
        abilityCardIsFaceUp = true;
        matchStatsToNewSelection();
        matchCoinsToStats();
        flipAllCoins();
      }

      function matchStatsToNewSelection(){ //this gets called when a player selects a new ability or creature card, to get rid of bonuses and update all the stats to match the new cards they have sleected
        currentCharacterBonuses = [0,0,0]; //cleanse bonuses when switching characters.
        currentCharacterStats[0] = abilityCardStats[abilityIndex - 1][0] + creatureCardStats[creatureIndex - 1][0];//update individual stats
        currentCharacterStats[1] = abilityCardStats[abilityIndex - 1][1] + creatureCardStats[creatureIndex - 1][1];
        currentCharacterStats[2] = abilityCardStats[abilityIndex - 1][2] + creatureCardStats[creatureIndex - 1][2];
      }

      function resetCoins(index){
        let coin;
        let parentElement;
        let fileNameString;
        switch (index){
          case 0:
            coin = strengthCoins.childNodes[1];
            parentElement = strengthCoins;
            fileNameString = "strength";
            break;
          case 1:
            coin = magicCoins.childNodes[1];
            parentElement = magicCoins;
            fileNameString = "magic";
            break;
          case 2:
            coin = smartsCoins.childNodes[2];
            parentElement = smartsCoins;
            fileNameString = "smarts";
            break;
        }
        
        for (let i = 0; i < currentCharacterStats[index]; i++){ //clear away current coins
          let coin = parentElement.childNodes[i*2+1];
          setTimeout(function(){ //fade it out
            coin.style.opacity = "0";
          }, 50 * i);
        }

        let resetTimeoutDelay = currentCharacterStats[index] * 50;

        currentCharacterBonuses[index] = 0; //cleanse bonuses when switching characters.
        currentCharacterStats[index] = abilityCardStats[abilityIndex - 1][index] + creatureCardStats[creatureIndex - 1][index];//update individual stats

        setTimeout(function(){
          let numOfChildElements = parentElement.childNodes.length;
          let numOfCoins = (numOfChildElements + 1) / 2 - 1; //count how many coins are on the page
          let delta = numOfCoins - currentCharacterStats[index]; //see what the difference is between them
          if (delta === 0){
            //great! do nothing
          } else if( delta < 0) { //we need to add coins
            for (let j = 0; j > delta; j--){ 
              //add in coins until the delta is gone
              let textNode = parentElement.childNodes[0].cloneNode(true);
              let coinNode = parentElement.childNodes[1].cloneNode(true);
              parentElement.appendChild(coinNode);
              parentElement.appendChild(textNode);
            }
          } else { // we must remove coins
            for (let j = 0; j < delta; j++){
              //remove coins until the delta is gone
              let textNode = parentElement.childNodes[0];
              let coinNode = parentElement.childNodes[1];
              parentElement.removeChild(textNode);
              parentElement.removeChild(coinNode);
            }
          }
        }, resetTimeoutDelay);

        setTimeout(function(){
          for (let i = 0; i < currentCharacterStats[index]; i++){ //loop through all the coins
            let coin = parentElement.childNodes[i*2+1];
            let headsOrTails = Math.floor(Math.random()*2); //flip the coin
            setTimeout(function(){
              if(headsOrTails === 0){
                coin.childNodes[0].src = "assets/images/coin-"+ fileNameString +"-heads.svg";
              } else {
                coin.childNodes[0].src = "assets/images/coin-"+ fileNameString +"-tails.svg";
              }
              coin.style.opacity = "1";
            }, 50 * i + 50 * currentCharacterStats[0] + 50)
          }
        }, resetTimeoutDelay);



      }

      function matchCoinsToStats() { //count how many coins are on the page, and add or remove coins in order to match the new creature/ability/stats
        let strengthCoins = document.getElementById("strengthCoins");
        let magicCoins = document.getElementById("magicCoins");
        let smartsCoins = document.getElementById("smartsCoins");

        let allCoins = [strengthCoins,magicCoins,smartsCoins];
        for (let i = 0 ; i < 3; i++){ //for each stat
          let numOfChildElements = allCoins[i].childNodes.length;
          let numOfCoins = (numOfChildElements + 1) / 2 - 1; //count how many coins are on the page
          let delta = numOfCoins - currentCharacterStats[i]; //see what the difference is between them
          console.log(delta)
          if (delta === 0){
            //great! do nothing
          } else if( delta < 0) { //we need to add coins
            for (let j = 0; j > delta; j--){ 
              //add in coins until the delta is gone
              let textNode = allCoins[i].childNodes[0].cloneNode(true);
              let coinNode = allCoins[i].childNodes[1].cloneNode(true);
              allCoins[i].appendChild(coinNode);
              allCoins[i].appendChild(textNode);
            }
          } else { // we must remove coins
            for (let j = 0; j < delta; j++){
              //remove coins until the delta is gone
              let textNode = allCoins[i].childNodes[0];
              let coinNode = allCoins[i].childNodes[1];
              allCoins[i].removeChild(textNode);
              allCoins[i].removeChild(coinNode);
            }
          }
        }
      }

      function flipCoins(target, statIndex){ //flip all of a single stat's coins
        let fileNameString = "strength";
        if (statIndex === undefined){
          statIndex = 0;
        } else if (statIndex === 1) {
          fileNameString = "magic";
        } else if (statIndex === 2) {
          fileNameString = "smarts";
        }
        let targetCoinsParentNode;

        if (target.innerHTML.includes("Flip")){
          targetCoinsParentNode = target.parentNode.parentNode.parentNode.childNodes[1]; 
          console.log(targetCoinsParentNode)
        } else if (target.parentNode.id === "strengthCoins"){
          //
          targetCoinsParentNode = target.parentNode;
          console.log(targetCoinsParentNode)
        } else if (target.parentNode.id === "magicCoins"){
          statIndex = 1;
          targetCoinsParentNode = target.parentNode;
        } else if (target.parentNode.id === "smartsCoins"){
          statIndex = 2;
          targetCoinsParentNode = target.parentNode;
        } 

        for (let i = 0; i < currentCharacterStats[statIndex]; i++){ //loop through all the coins
          let coin = targetCoinsParentNode.childNodes[i*2+1];
          setTimeout(function(){ //fade it out
            coin.style.opacity = "0";
          }, 50 * i);
          let headsOrTails = Math.floor(Math.random()*2); //flip the coin
          setTimeout(function(){
            if(headsOrTails === 0){
              coin.childNodes[0].src = "assets/images/coin-"+ fileNameString +"-heads.svg";
            } else {
              coin.childNodes[0].src = "assets/images/coin-"+ fileNameString +"-tails.svg";
            }
            coin.style.opacity = "1";
          }, 50 * i + 50 * currentCharacterStats[0] + 200)
        }
      }

      function bonusCoins(target){
        strengthCoins = document.getElementById("strengthCoins");
        magicCoins = document.getElementById("magicCoins");
        smartsCoins = document.getElementById("smartsCoins");

        let allCoins = [strengthCoins,magicCoins,smartsCoins];
        let numOfChildElements = [allCoins[0].childNodes.length,allCoins[1].childNodes.length,allCoins[2].childNodes.length]

        let i;
        if (target.id.includes("minus")){
          if (target.id.includes("strength")){ //remove strength
            i = 0;
          } else if (target.id.includes("magic")){ //remove magic
            i = 1;
          } else { //remove smarts
            i = 2;
          }
          if (currentCharacterStats[i] > 1){
            currentCharacterBonuses[i]--;//keep track of this bonus
            currentCharacterStats[i]--;//and apply it to the stats

            let textNode = allCoins[i].childNodes[0];
            let coinNode = allCoins[i].childNodes[1];
            allCoins[i].removeChild(textNode);
            allCoins[i].removeChild(coinNode);

          } else {
            alert("You can't have less than one coin! Or you're dead");
          }
        } else { //plus
          if (target.id.includes("strength")){ //add strength
            i = 0;
          } else if (target.id.includes("magic")){ //add magic
            i = 1;
          } else { //add smarts
            i = 2;
          }
          if (currentCharacterBonuses[i] < 8){
            currentCharacterBonuses[i]++;//keep track of this bonus
            currentCharacterStats[i]++;//and apply it to the stats

            let textNode = allCoins[i].childNodes[0].cloneNode(true);
            let coinNode = allCoins[i].childNodes[1].cloneNode(true);
            allCoins[i].appendChild(coinNode);
            allCoins[i].appendChild(textNode);
          } else {
            alert("You can't have a bonus that big :)");
          }

        }
      }

      strength.onmouseenter = function(){
        if(allow_hover_effects){
          strengthControls.style.opacity = "1";
          strengthControls.style.height = "37px";
        }
      }
      strength.onmouseleave = function(){
        if(allow_hover_effects){
          strengthControls.style.opacity = "0";
          strengthControls.style.height = "0px";
        }
      }

      magic.onmouseenter = function(){
        if(allow_hover_effects){
        magicControls.style.opacity = "1";
        magicControls.style.height = "37px";
        }
      }
      magic.onmouseleave = function(){
        if(allow_hover_effects){
        magicControls.style.opacity = "0";
        magicControls.style.height = "0px";
        }
      }

      smarts.onmouseenter = function(){
        if(allow_hover_effects){
        smartsControls.style.opacity = "1";
        smartsControls.style.height = "37px";
        }
      }
      smarts.onmouseleave = function(){
        if(allow_hover_effects){
        smartsControls.style.opacity = "0";
        smartsControls.style.height = "0px";
        }
      }

      creatureCard.onclick = function(){
        if (!animationInProgress.creature){
          animationInProgress.creature = true;
          if (creatureCardIsFaceUp){
            creatureCard.style.transform = "rotateY(180deg)";
            setTimeout(function(){
              creatureCard.src = "assets/images/Creature-" + creatureIndex+"-back.jpg";
              creatureCardIsFaceUp = false;
              animationInProgress.creature = false;
            },250)
          } else {
            creatureCard.style.transform = "rotateY(0deg)";
            setTimeout(function(){
              creatureCard.src = "assets/images/Creature-" + creatureIndex+"-front.jpg";
              creatureCardIsFaceUp = true;
              animationInProgress.creature = false;
            },250)
          }
        }
      }

      abilityCard.onclick = function(){
        if (!animationInProgress.ability){
          animationInProgress.ability = true;
          if (abilityCardIsFaceUp){
            abilityCard.style.transform = "rotateY(180deg)";
            setTimeout(function(){
              abilityCard.src = "assets/images/Ability-" + abilityIndex+"-back.jpg";
              abilityCardIsFaceUp = false;
              animationInProgress.ability = false;
            },250)
          } else {
            abilityCard.style.transform = "rotateY(0deg)";
            setTimeout(function(){
              abilityCard.src = "assets/images/Ability-" + abilityIndex+"-front.jpg";
              abilityCardIsFaceUp = true;
              animationInProgress.ability = false;
            },250)
          }
        }
      }

      function flipAllCoins(){
        let firstStrengthCoin = strengthCoins.childNodes[1];
        let firstMagicCoin = magicCoins.childNodes[1];
        let firstSmartsCoin = smartsCoins.childNodes[1];
        flipCoins(firstStrengthCoin,true);
        flipCoins(firstMagicCoin,true);
        flipCoins(firstSmartsCoin,true);
      }

      function preloadImage(url){
          var img=new Image();
          img.src=url;
      }

    function watchForHover() {
      // fired a few milliseconds after touchstart to filter them.
      let lastTouchTime = 0

      function enableHover() {
        if (new Date() - lastTouchTime < 500) return
        document.body.classList.add('hasHover')
        allow_hover_effects = true;
      }

      function disableHover() {
        document.body.classList.remove('hasHover')
        allow_hover_effects = false;
      }

      function updateLastTouchTime() {
        lastTouchTime = new Date()
      }

      document.addEventListener('touchstart', updateLastTouchTime, true)
      document.addEventListener('touchstart', disableHover, true)
      document.addEventListener('mousemove', enableHover, true)

      enableHover()
    }

    watchForHover()

    </script>

    <footer>
      <figure>
        <img src="assets/images/FlipTales-Free-Sample.png" alt="rendering of FlipTales box and contents">
      </figure>
      <form class="button" action="https://eepurl.com/dBOAbr" method="get">
        <input type="submit" name="sign up button" value="Sign me up!">
      </form>
      <h1>
        <a href="https://instagram.com/playfliptales">
          <img class="social" src="assets/images/38-instagram.svg"></img>
        </a>
        <a href="https://twitter.com/playfliptales">
          <img class="social" src="assets/images/03-twitter.svg"></img>
        </a>
      </h1>
    </footer>
  </body>
